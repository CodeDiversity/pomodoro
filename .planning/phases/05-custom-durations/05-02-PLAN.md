---
phase: 05-custom-durations
plan: 02
type: execute
wave: 2
depends_on:
  - 05-01
files_modified:
  - src/components/Settings.tsx
  - src/App.tsx
autonomous: true
requirements:
  - DUR-01
  - DUR-02
  - DUR-03
  - DUR-05
user_setup: []
must_haves:
  truths:
    - User can input custom Focus duration between 1-60 minutes
    - User can input custom Short Break duration between 1-30 minutes
    - User can input custom Long Break duration between 1-60 minutes
    - Duration inputs show real-time validation errors when out of bounds
  artifacts:
    - path: src/components/Settings.tsx
      provides: Duration input UI with validation
      contains: DurationInput component with +/- steppers
  key_links:
    - from: Settings.tsx
      to: useTimer setCustomDurations
      via: props.onSaveDurations
      pattern: setCustomDurations
    - from: Settings.tsx
      to: persistence.ts
      via: saveSettings call
      pattern: saveSettings.*focusDuration
---

<objective>
Implement Settings UI with duration inputs and validation.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/05-custom-durations/05-CONTEXT.md
@.planning/phases/05-custom-durations/05-RESEARCH.md
@src/components/Settings.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Add DurationInput component with +/- stepper</name>
  <files>src/components/Settings.tsx</files>
  <action>
    1. Create DurationInput component inside Settings.tsx (inline):
       - Props: label, value (number), onChange (function), min, max
       - Render: label, stepper button (-) that decrements by 1, number input, stepper button (+) that increments by 1
       - Number input allows direct typing (use standard <input type="number">)
       - Stepper buttons call onChange with value +/- 1

    2. Add local state for duration inputs (in minutes for UI display):
       - focusMinutes, shortBreakMinutes, longBreakMinutes (numbers)
       - Initialize from props.customDurations converted to minutes (divide by 60)

    3. Add props interface for Settings:
       - customDurations: { focus: number; shortBreak: number; longBreak: number } (in seconds)
       - onSaveDurations: (durations: { focus: number; shortBreak: number; longBreak: number }) => void
  </action>
  <verify>npm run build compiles with no errors</verify>
  <done>Component renders number input; component has + button that increments by 1; component has - button that decrements by 1; user can type directly in input field</done>
</task>

<task type="auto">
  <name>Add three duration inputs to Settings panel</name>
  <files>src/components/Settings.tsx</files>
  <action>
    1. Add three DurationInput components to Settings panel:
       - Focus duration: label "Focus", min=1, max=60, range 1-60 minutes
       - Short Break duration: label "Short Break", min=1, max=30, range 1-30 minutes
       - Long Break duration: label "Long Break", min=1, max=60, range 1-60 minutes

    2. Add real-time inline validation for each input:
       - Compute error if value < min or > max
       - Display error message below input when out of bounds
       - Error message format: "Must be between X and Y minutes"

    3. Add Save button:
       - On click: call onSaveDurations with durations in seconds (minutes * 60)
       - Button shows "Save"
       - On save: applies to timer (idle = update display, running = reset per DUR-08)
  </action>
  <verify>npm run build compiles with no errors</verify>
  <done>Focus duration input: range 1-60 minutes; Short Break duration input: range 1-30 minutes; Long Break duration input: range 1-60 minutes; real-time inline validation shows error when out of bounds; error message: "Must be between X-Y minutes"; save button persists all three durations at once; on save: applies to timer (idle = update display, running = reset)</done>
</task>

<task type="auto">
  <name>Connect Settings to App and useTimer</name>
  <files>src/App.tsx</files>
  <action>
    1. Destructure setCustomDurations from useTimer return object

    2. Update Settings component usage in App.tsx:
       - Pass customDurations prop with { focus, shortBreak, longBreak } from timer state
       - Pass onSaveDurations callback that:
         a. Calls saveSettings with all settings including durations (persists to IndexedDB)
         b. Calls setCustomDurations with the new durations (applies to timer)

    3. Ensure customDurations are passed correctly:
       - Timer state stores durations in seconds
       - Settings converts to minutes for display, converts back to seconds in onSaveDurations
  </action>
  <verify>npm run build compiles with no errors</verify>
  <done>Settings passes custom durations to useTimer via setCustomDurations; Settings persists to IndexedDB via saveSettings; App correctly wires both</done>
</task>

</tasks>

<verification>
- DUR-01: Focus input accepts 1-60 minutes
- DUR-02: Short Break input accepts 1-30 minutes
- DUR-03: Long Break input accepts 1-60 minutes
- DUR-05: Validation errors shown in real-time for out of bounds values
</verification>

<success_criteria>
- User can input Focus duration between 1-60 minutes
- User can input Short Break duration between 1-30 minutes
- User can input Long Break duration between 1-60 minutes
- Validation errors show "Must be between X and Y minutes"
- Save button saves durations and applies them to timer
</success_criteria>

<output>
After completion, create .planning/phases/05-custom-durations/05-02-SUMMARY.md
</output>
