---
phase: 05-custom-durations
plan: 02
type: execute
wave: 2
depends_on:
  - 05-01
files_modified:
  - src/components/Settings.tsx
  - src/App.tsx
autonomous: true
requirements:
  - DUR-01
  - DUR-02
  - DUR-03
  - DUR-05
user_setup: []
must_haves:
  truths:
    - User can input custom Focus duration between 1-60 minutes
    - User can input custom Short Break duration between 1-30 minutes
    - User can input custom Long Break duration between 1-60 minutes
    - Duration inputs show real-time validation errors when out of bounds
  artifacts:
    - path: src/components/Settings.tsx
      provides: Duration input UI with validation
      contains: DurationInput component with +/- steppers
  key_links:
    - from: Settings.tsx
      to: useTimer setCustomDurations
      via: props.onSaveDurations
      pattern: setCustomDurations
    - from: Settings.tsx
      to: persistence.ts
      via: saveSettings call
      pattern: saveSettings.*focusDuration
---

<objective>
Implement Settings UI with duration inputs and validation.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/05-custom-durations/05-CONTEXT.md
@.planning/phases/05-custom-durations/05-RESEARCH.md
@src/components/Settings.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Add duration inputs to Settings component</name>
  <files>src/components/Settings.tsx</files>
  <action>
    1. Add props interface for new settings:
       - customDurations: { focus: number; shortBreak: number; longBreak: number } (in seconds)
       - onSaveDurations: (durations: { focus: number; shortBreak: number; longBreak: number }) => void

    2. Add local state for duration inputs (in minutes for UI):
       - focusMinutes, shortBreakMinutes, longBreakMinutes
       - Initialize from props.customDurations converted to minutes

    3. Create DurationInput component (inline or separate):
       - Props: label, value, onChange, min, max
       - Render: label, stepper button (-), number input, stepper button (+)
       - Number input allows direct typing
       - Stepper buttons adjust by 1 minute

    4. Add real-time validation:
       - For each input, compute error if value < min or > max
       - Error message format: "Must be between X and Y minutes"
       - Focus: 1-60, Short Break: 1-30, Long Break: 1-60

    5. Add Save button:
       - On click: call onSaveDurations with durations in seconds (minutes * 60)
       - Button shows "Save" (not "Apply" or "Apply & close")

    6. Style to match existing Settings panel aesthetics
  </action>
  <verify>npm run build compiles with no errors</verify>
  <done>Settings panel has three duration inputs with +/- steppers, real-time validation, and Save button</done>
</task>

<task type="auto">
  <name>Connect Settings to App and useTimer</name>
  <files>src/App.tsx</files>
  <action>
    1. Destructure setCustomDurations from useTimer return object

    2. Update Settings component usage:
       - Pass customDurations prop with { focus, shortBreak, longBreak } from timer state
       - Pass onSaveDurations callback that:
         - Calls setCustomDurations with the new durations
         - Also calls saveSettings with all settings including durations

    3. Ensure customDurations are passed correctly (convert seconds to minutes in Settings, then back to seconds in onSaveDurations)
  </action>
  <verify>npm run build compiles with no errors</verify>
  <done>Settings passes custom durations to useTimer and persistence</done>
</task>

</tasks>

<verification>
- DUR-01: Focus input accepts 1-60 minutes
- DUR-02: Short Break input accepts 1-30 minutes
- DUR-03: Long Break input accepts 1-60 minutes
- DUR-05: Validation errors shown in real-time for out of bounds values
</verification>

<success_criteria>
- User can input Focus duration between 1-60 minutes
- User can input Short Break duration between 1-30 minutes
- User can input Long Break duration between 1-60 minutes
- Validation errors show "Must be between X and Y minutes"
- Save button saves durations and applies them to timer
</success_criteria>

<output>
After completion, create .planning/phases/05-custom-durations/05-02-SUMMARY.md
</output>
