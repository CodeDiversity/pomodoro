---
phase: 21-read-only-display
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - /Users/michaelrobert/Documents/GitHub/pomodoro/src/components/SessionSummary.tsx
  - /Users/michaelrobert/Documents/GitHub/pomodoro/src/components/history/HistoryDrawer.tsx
autonomous: true
requirements:
  - RTD-01
  - RTD-02
  - RTD-03
  - RTD-04
  - RTD-05
  - RTD-06

must_haves:
  truths:
    - "User can see formatted notes (bold, bullets, links) in session summary modal after completing a focus session"
    - "User can view formatted notes in history details drawer"
    - "User can toggle between edit and view modes in history drawer"
    - "Empty notes do not display in session summary"
  artifacts:
    - path: "src/components/SessionSummary.tsx"
      provides: "Session summary modal with RichTextDisplay for notes"
      min_lines: 220
      exports: ["default"]
    - path: "src/components/history/HistoryDrawer.tsx"
      provides: "History drawer with RichTextDisplay and edit/view toggle"
      min_lines: 410
      exports: ["HistoryDrawer"]
  key_links:
    - from: "src/components/SessionSummary.tsx"
      to: "src/components/RichTextDisplay.tsx"
      via: "import and render component"
      pattern: "import RichTextDisplay"
    - from: "src/components/history/HistoryDrawer.tsx"
      to: "src/components/RichTextDisplay.tsx"
      via: "import and conditional render"
      pattern: "import RichTextDisplay"
---

<objective>
Integrate RichTextDisplay component into SessionSummary modal and HistoryDrawer to display formatted notes (bold, bullet lists, links) instead of plain text or raw HTML.
</objective>

<execution_context>
@/Users/michaelrobert/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelrobert/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@/Users/michaelrobert/Documents/GitHub/pomodoro/.planning/phases/21-read-only-display/21-RESEARCH.md
@/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/RichTextDisplay.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add RichTextDisplay to SessionSummary modal</name>
  <files>/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/SessionSummary.tsx</files>
  <action>
1. Import RichTextDisplay at the top of the file:
   `import RichTextDisplay from './RichTextDisplay'`

2. Add a Notes section to the DetailsCard component (around line 213, after the Completed section):
   ```typescript
   {session.noteText && (
     <DetailSection>
       <DetailLabel>Notes</DetailLabel>
       <RichTextDisplay content={session.noteText} />
     </DetailSection>
   )}
   ```
   Note: The DetailValue styling may need adjustment to accommodate RichTextDisplay styles.
  </action>
  <verify>
npm run build 2>&1 | head -30
</verify>
  <done>
SessionSummary modal displays formatted notes with bold, bullet lists, and clickable links after session completion. Empty notes do not show the Notes section.
</done>
</task>

<task type="auto">
  <name>Task 2: Add edit/view toggle to HistoryDrawer</name>
  <files>/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/history/HistoryDrawer.tsx</files>
  <action>
1. Import RichTextDisplay at the top of the file (around line 7):
   `import RichTextDisplay from '../RichTextDisplay'`

2. Add state for edit mode toggle (around line 264):
   `const [isEditingNotes, setIsEditingNotes] = useState(true)`
   Note: Default to true to maintain backward compatibility with existing behavior.

3. Add a toggle button in the DetailLabel for Note (around line 368):
   ```typescript
   <DetailLabel style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
     Note
     <button
       onClick={() => setIsEditingNotes(!isEditingNotes)}
       style={{ fontSize: '12px', padding: '4px 8px', cursor: 'pointer' }}
     >
       {isEditingNotes ? 'View' : 'Edit'}
     </button>
   </DetailLabel>
   ```

4. Replace the NoteTextArea conditional rendering (lines 369-377):
   ```typescript
   {isEditingNotes ? (
     <>
       <NoteTextArea
         value={noteText}
         onChange={(e) => handleNoteChange(e.target.value)}
         placeholder="Add a note..."
       />
       <SaveStatus $saving={isSaving}>
         {isSaving ? 'Saving...' : 'Saved'}
       </SaveStatus>
     </>
   ) : (
     <RichTextDisplay content={noteText || ''} />
   )}
   ```
  </action>
  <verify>
npm run build 2>&1 | head -30
</verify>
  <done>
HistoryDrawer displays formatted notes in view mode with bold, bullet lists, and clickable links. User can toggle between Edit and View modes to see formatted notes or edit plain text.
</done>
</task>

</tasks>

<verification>
1. Build succeeds without errors
2. Both components import RichTextDisplay correctly
3. TypeScript compiles without errors
</verification>

<success_criteria>
- SessionSummary modal shows formatted notes with bold, bullets, and links (RTD-01, RTD-02, RTD-03)
- HistoryDrawer shows formatted notes in view mode (RTD-04, RTD-05, RTD-06)
- HistoryDrawer maintains edit functionality with toggle
- All existing functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/21-read-only-display/21-01-SUMMARY.md`
</output>
