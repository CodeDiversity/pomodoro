---
phase: 11-settings-modernization
plan: 02
type: execute
wave: 2
depends_on: [11-01]
files_modified:
  - src/services/audio.ts
  - src/components/settings/SoundSettings.tsx
autonomous: true

must_haves:
  truths:
    - "Audio service supports multiple sound types (beep, chime, bell, digital)"
    - "Audio service respects volume parameter (0-100%)"
    - "SoundSettings component allows sound selection with dropdown"
    - "SoundSettings component has preview button that plays selected sound"
  artifacts:
    - path: "src/services/audio.ts"
      provides: "Audio playback with multiple sounds and volume control"
      exports: ["playSound", "SoundType"]
    - path: "src/components/settings/SoundSettings.tsx"
      provides: "Sound selection UI with dropdown and preview"
      exports: ["SoundSettings"]
  key_links:
    - from: "SoundSettings.tsx"
      to: "audio.ts"
      via: "playSound function call"
    - from: "SoundSettings.tsx"
      to: "store.ts"
      via: "useAppSelector, useAppDispatch"
---

<objective>
Enhance audio service for multiple sounds with volume control and create SoundSettings component

Purpose: Extend the audio service to support multiple sound types (beep, chime, bell, digital) with volume control via GainNode, and create a reusable SoundSettings component with dropdown selection and preview button.

Output: Enhanced audio.ts, new SoundSettings.tsx component
</objective>

<context>
@src/services/audio.ts
@.planning/phases/11-settings-modernization/11-RESEARCH.md
@src/features/settings/settingsSlice.ts
</context>

<tasks>

<task type="auto">
  <name>Enhance audio.ts for multiple sounds with volume</name>
  <files>src/services/audio.ts</files>
  <action>
In src/services/audio.ts:
1. Export SoundType type: 'beep' | 'chime' | 'bell' | 'digital'
2. Create SOUND_CONFIGS constant with frequency, type, duration for each sound:
   - beep: frequency 880, type sine, duration 0.2
   - chime: frequency 523, type sine, duration 0.5
   - bell: frequency 392, type triangle, duration 0.8
   - digital: frequency 1200, type square, duration 0.15
3. Export async function playSound(soundType: SoundType, volume: number = 80):
   - Get AudioContext
   - Resume if suspended
   - Get config for soundType
   - Normalize volume (volume / 100)
   - Create oscillator with config frequency and type
   - Create gainNode for volume control with envelope
   - Connect oscillator -> gainNode -> destination
   - Start and stop oscillator per config duration
   - Clean up on ended
4. Keep existing playBeep() function for backward compatibility but have it call playSound('beep', 80)
5. Keep isAudioAvailable() function
  </action>
  <verify>npm run build succeeds</verify>
  <done>audio.ts supports multiple sounds with configurable volume</done>
</task>

<task type="auto">
  <name>Create SoundSettings component</name>
  <files>src/components/settings/SoundSettings.tsx</files>
  <action>
Create src/components/settings/SoundSettings.tsx:
1. Import playSound, SoundType from '../../services/audio'
2. Import useAppSelector, useAppDispatch from '../../app/hooks'
3. Import setNotificationSound, setVolume from '../../features/settings/settingsSlice'
4. Create styled components matching design system:
   - SectionContainer: margin-bottom 24px
   - SectionTitle: uppercase, small, muted color
   - SettingRow: flex container
   - Label: font-size 0.95rem, color #333
   - SoundSelect: styled select with padding, border, border-radius, focus states
   - PreviewButton: primary color background, white text, hover state
   - SliderContainer: flex, align-center, gap 12px
   - Slider: range input with accent-color primary
   - VolumeValue: min-width 40px, text-right, muted color
5. SoundSettings component:
   - Use useAppSelector to get notificationSound and volume from settings
   - Use useAppDispatch for actions
   - Render SoundSelect dropdown with options: beep, chime, bell, digital
   - Render PreviewButton that calls playSound(selectedSound, volume)
Slider with range input 0-100   - Render Volume
   - On sound change: dispatch setNotificationSound
   - On volume change: dispatch setVolume

Match existing styled-components patterns from Settings.tsx.
  </action>
  <verify>npm run build succeeds</verify>
  <done>SoundSettings component created with dropdown, preview, and volume slider</done>
</task>

</tasks>

<verification>
- [ ] audio.ts exports SoundType
- [ ] audio.ts exports playSound with soundType and volume parameters
- [ ] SOUND_CONFIGS defines 4 sound types
- [ ] playSound creates oscillator, gainNode, and envelope
- [ ] SoundSettings.tsx created in src/components/settings/
- [ ] SoundSettings uses Redux for state
- [ ] SoundSettings has dropdown with 4 options
- [ ] SoundSettings has preview button
- [ ] SoundSettings has volume slider 0-100
- [ ] Build succeeds
</verification>

<success_criteria>
Audio service supports 4 sound types with volume control, SoundSettings component provides UI for selection and preview
</success_criteria>

<output>
After completion, create .planning/phases/11-settings-modernization/11-02-SUMMARY.md
</output>
