---
phase: 01-foundation
plan: '01'
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: true
requirements: [TMR-01, TMR-02, TMR-03, TMR-09, TMR-10, DATA-01, DATA-02, DATA-03]

must_haves:
  truths:
    - "Timer displays time in MM:SS format"
    - "Timer supports Focus (25:00), Short Break (5:00), Long Break (15:00) modes"
    - "After 4 focus sessions, timer auto-selects Long Break; otherwise Short Break"
    - "Display shows current mode (Focus/Short Break/Long Break)"
    - "Display shows session count (e.g., Session 2)"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies including React, TypeScript, Vite, idb"
    - path: "src/types/timer.ts"
      provides: "Timer mode types, state interface"
    - path: "src/constants/timer.ts"
      provides: "Timer durations and configuration"
    - path: "src/hooks/useTimer.ts"
      provides: "Timestamp-based timer logic"
    - path: "src/components/TimerDisplay.tsx"
      provides: "MM:SS display with mode badge"
  key_links:
    - from: "src/hooks/useTimer.ts"
      to: "src/types/timer.ts"
      via: "imports TimerMode, TimerState types"
    - from: "src/components/TimerDisplay.tsx"
      to: "src/hooks/useTimer.ts"
      via: "uses useTimer hook for time and mode"
---

<objective>
Initialize the Pomodoro Timer project and build core timer logic with MM:SS display, mode switching, and session tracking.
</objective>

<execution_context>
@/Users/michaelrobert/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelrobert/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Initialize Vite + React + TypeScript project</name>
  <files>package.json, vite.config.ts, tsconfig.json, index.html, src/main.tsx, src/App.tsx, src/vite-env.d.ts</files>
  <action>
    Create a new Vite project with React and TypeScript:
    1. Run `npm create vite@latest . -- --template react-ts` to scaffold project
    2. Install dependencies: `npm install`
    3. Install idb library: `npm install idb` (per locked decision in research)
    4. Verify project runs: `npm run dev`

    Structure created:
    - package.json with react, react-dom, idb, vite dependencies
    - vite.config.ts for build configuration
    - tsconfig.json for TypeScript
    - index.html entry point
    - src/main.tsx React mount
    - src/App.tsx main component
  </action>
  <verify>Run `npm run build` to verify project compiles without errors</verify>
  <done>Project initialized with React 18 + TypeScript + Vite + idb library</done>
</task>

<task type="auto">
  <name>Create project folder structure and types</name>
  <files>src/types/timer.ts, src/constants/timer.ts</files>
  <action>
    Create folder structure and core type definitions:
    1. Create directories: src/hooks/, src/services/, src/components/, src/types/, src/constants/, src/utils/
    2. Create src/types/timer.ts with:
       - TimerMode type: 'focus' | 'shortBreak' | 'longBreak'
       - TimerState interface: mode, timeRemaining, isRunning, sessionCount, lastTick
       - TimerAction types for reducer
    3. Create src/constants/timer.ts with:
       - DURATIONS: { focus: 25 * 60, shortBreak: 5 * 60, longBreak: 15 * 60 } in seconds
       - SESSIONS_BEFORE_LONG_BREAK: 4
       - DEFAULT_STATE: initial timer state

    Use timestamp-based approach per research: store duration and startTime, calculate remaining = duration - (Date.now() - startTime)
  </action>
  <verify>Run `npm run build` to verify TypeScript types compile</verify>
  <done>Project structure created with timer types and constants</done>
</task>

<task type="auto">
  <name>Create useTimer hook with timestamp-based logic</name>
  <files>src/hooks/useTimer.ts</files>
  <action>
    Create the useTimer custom hook:
    1. Implement timestamp-based countdown: use Date.now() - startTime to calculate remaining
    2. Use useReducer for predictable state transitions
    3. Handle actions: START, PAUSE, RESUME, RESET, SKIP, TICK
    4. Implement auto Long Break after 4 focus sessions (TMR-03)
    5. Start/Pause/Resume toggle functionality
    6. Skip to next session (Focus <-> Break)
    7. Reset to initial duration for current mode

    Key logic per research:
    - Store: { mode, duration, startTime (or null), pausedTimeRemaining (or null), sessionCount, isRunning }
    - Running: remaining = duration - (Date.now() - startTime)
    - Paused: use pausedTimeRemaining directly
    - On skip: if Focus -> determine break type based on sessionCount, else -> Focus + increment session
  </action>
  <verify>Run `npm run build` to verify hook compiles without errors</verify>
  <done>useTimer hook implements: start, pause, resume, skip, reset, auto break selection after 4 focus sessions</done>
</task>

<task type="auto">
  <name>Create TimerDisplay component</name>
  <files>src/components/TimerDisplay.tsx</files>
  <action>
    Create the TimerDisplay component:
    1. Display time in MM:SS format (e.g., "25:00") - TMR-01
    2. Show current mode with text badge (Focus/Short Break/Long Break) - TMR-09
    3. Show session count (e.g., "Session 2 of 4") - TMR-10
    4. Use color-coded backgrounds for modes per user decision (focus=red, shortBreak=orange, longBreak=blue)
    5. Make timer numbers large and prominent ("hero element")

    Format helper: formatTime(seconds: number) -> "MM:SS" string
    Use CSS for bold/prominent styling - large font size, centered, clear visibility
  </action>
  <verify>Run `npm run build` to verify component compiles</verify>
  <done>TimerDisplay shows: MM:SS time, mode badge with colors, session counter</done>
</task>

</tasks>

<verification>
- Timer displays in MM:SS format (TMR-01)
- Three modes work: Focus 25:00, Short Break 5:00, Long Break 15:00 (TMR-02)
- After 4 focus sessions, Long Break auto-selected (TMR-03)
- Mode displayed with text badge (TMR-09)
- Session count displayed (TMR-10)
</verification>

<success_criteria>
- Project builds without errors
- Timer renders with MM:SS display
- Mode switching works correctly
- Session counting works (after 4 focus -> long break)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
