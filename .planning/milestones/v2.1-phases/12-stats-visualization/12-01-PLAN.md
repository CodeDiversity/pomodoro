---
phase: 12-stats-visualization
plan: '01'
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/components/stats/WeeklyChart.tsx
  - src/App.tsx
autonomous: true
requirements:
  - STAT-01
  - STAT-02
  - STAT-03
  - STAT-04

must_haves:
  truths:
    - User can see bar chart with 7 bars representing last 7 days of focus time
    - Bar heights correspond to total focus time for each day
    - Hovering a bar shows tooltip with readable duration (e.g., "2h 15m")
    - Bars use app blue color scheme with gradient based on duration
    - Chart animates on initial render
    - Zero days show minimal bar instead of empty space
  artifacts:
    - path: src/components/stats/WeeklyChart.tsx
      provides: Bar chart component with Chart.js
      exports: WeeklyChart component
    - path: src/App.tsx
      provides: Stats view integration with WeeklyChart
      contains: WeeklyChart rendered in stats view mode
  key_links:
    - from: src/components/stats/WeeklyChart.tsx
      to: react-chartjs-2 Bar
      via: imports Bar from react-chartjs-2
    - from: src/components/stats/WeeklyChart.tsx
      to: src/utils/statsUtils
      via: uses formatDuration for tooltip
    - from: WeeklyChart
      to: IndexedDB sessions
      via: receives aggregated data via props
---

<objective>
Implement weekly bar chart visualization for focus time tracking in Stats view.

Purpose: Visualize daily focus time over the last 7 days with interactive tooltips and gradient coloring based on duration intensity.

Output: WeeklyChart.tsx component integrated into Stats view, Chart.js dependencies installed.
</objective>

<execution_context>
@/Users/michaelrobert/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelrobert/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-stats-visualization/12-CONTEXT.md
@.planning/phases/12-stats-visualization/12-RESEARCH.md
@src/components/stats/StatsGrid.tsx
@src/utils/statsUtils.ts
@src/App.tsx (lines 478-490 show stats view rendering)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Chart.js dependencies</name>
  <files>package.json</files>
  <action>
    Install chart.js and react-chartjs-2 packages:
    npm install chart.js react-chartjs-2

    Verify installation by checking package.json for added dependencies.
  </action>
  <verify>npm list chart.js react-chartjs-2 shows installed packages</verify>
  <done>chart.js and react-chartjs-2 appear in package.json dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create WeeklyChart component</name>
  <files>src/components/stats/WeeklyChart.tsx</files>
  <action>
    Create WeeklyChart.tsx component with the following specifications:

    1. Import Bar from 'react-chartjs-2' and register Chart.js components (CategoryScale, LinearScale, BarElement, Tooltip)
    2. Accept data prop: { date: Date; totalSeconds: number }[]
    3. Use formatDuration from '../../utils/statsUtils' for tooltip display
    4. Create chart data with:
       - Labels: format dates as "M/D" (e.g., "2/17", "2/18")
       - Dataset: data.map(d => d.totalSeconds === 0 ? 30 : d.totalSeconds) for minimal bar
       - backgroundColor: gradient from light blue (#60a5fa) to dark blue (#136dec) based on ratio
       - For zero days: subtle gray (rgba(229, 231, 235, 0.5))
       - borderRadius: 8
       - borderSkipped: false
    5. Configure options:
       - responsive: true
       - maintainAspectRatio: false
       - animation: duration 800ms, easing 'easeOutQuart'
       - plugins.tooltip: custom callbacks for title (date) and label (formatted duration)
       - scales.y: display: false, beginAtZero: true
       - scales.x: grid display: false
    6. Wrap in container with height: '300px', width: '100%'
  </action>
  <verify>npm run build compiles without errors</verify>
  <done>WeeklyChart.tsx exports functional component with Chart.js bar chart</done>
</task>

<task type="auto">
  <name>Task 3: Integrate WeeklyChart into Stats view</name>
  <files>src/App.tsx</files>
  <action>
    Update src/App.tsx to integrate WeeklyChart into the stats view:

    1. Import WeeklyChart from './components/stats/WeeklyChart'
    2. In the stats view section (around line 479), modify the render to include:
       - Date range title above chart (e.g., "Feb 17 - Feb 23")
       - WeeklyChart component below title
       - Use inline styled divs with white background, borderRadius: 12px, boxShadow matching existing StatsGrid styling
       - Get last 7 days of focus session data from IndexedDB
       - Aggregate sessions by day (filter for mode === 'focus', sum actualDurationSeconds)
       - Pass aggregated data to WeeklyChart

    The stats view should have:
    - Title showing date range (dynamic based on current week)
    - WeeklyChart component
    - Keep existing StatsGrid below or above the chart

    Follow existing patterns for data loading (useEffect + getAllSessions from sessionStore).
  </action>
  <verify>Build succeeds and Stats view renders without errors</verify>
  <done>Stats view displays WeeklyChart with last 7 days of focus data</done>
</task>

</tasks>

<verification>
- [ ] npm run build succeeds without errors
- [ ] Stats view (via sidebar "Stats" navigation) renders without crash
- [ ] WeeklyChart displays 7 bars representing last 7 days
- [ ] Bar heights vary based on focus time (test with different session data)
- [ ] Hovering bar shows tooltip with readable duration
- [ ] Zero days show minimal/subtle bar (not empty space)
- [ ] Chart uses blue color scheme
- [ ] Chart animates on initial render
</verification>

<success_criteria>
- WeeklyChart component renders in Stats view with 7 bars
- Each bar height represents total focus time for that day
- Tooltip shows duration in format like "2h 15m"
- Bars colored with blue gradient (light to dark based on duration)
- Zero days show minimal bar
- Chart animates on initial render
- Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/12-stats-visualization/12-01-SUMMARY.md`
</output>
