---
phase: 09-ui-session-slices
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/features/ui/uiSlice.ts
  - src/app/store.ts
  - src/App.tsx
autonomous: true
user_setup: []

must_haves:
  truths:
    - "viewMode (timer/history/stats/settings) managed in Redux"
    - "History drawer open/close controlled via Redux actions"
    - "Session summary modal visibility controlled via Redux actions"
  artifacts:
    - path: "src/features/ui/uiSlice.ts"
      provides: "UI state slice with viewMode, drawer, modal state"
      exports: ["setViewMode", "openDrawer", "closeDrawer", "showSummaryModal", "hideSummaryModal"]
    - path: "src/app/store.ts"
      provides: "Store with ui slice added"
      contains: "ui: uiReducer"
    - path: "src/App.tsx"
      provides: "App using Redux for UI state"
      contains: "useAppSelector.*viewMode"
  key_links:
    - from: "src/App.tsx"
      to: "src/features/ui/uiSlice.ts"
      via: "useAppSelector + useAppDispatch"
      pattern: "useAppSelector.*ui"
---

<objective>
Create UI slice for managing viewMode, drawer state, and modal visibility in Redux.

Purpose: Centralize UI state management (navigation, drawer, modals) following Phase 8 patterns. Enables Redux DevTools visibility for UI state transitions.

Output: uiSlice.ts, updated store.ts, App.tsx wired to Redux for UI state.
</objective>

<execution_context>
@/Users/dev/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/09-ui-session-slices/09-RESEARCH.md
@src/features/timer/timerSlice.ts
@src/app/store.ts
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Create UI slice</name>
  <files>src/features/ui/uiSlice.ts</files>
  <action>
Create src/features/ui/uiSlice.ts following the timerSlice pattern:

1. Define ViewMode type: 'timer' | 'history' | 'stats' | 'settings'
2. Define UIState interface with: viewMode, isDrawerOpen, selectedSessionId, showSummary
3. Create initialState with defaults: viewMode='timer', isDrawerOpen=false, selectedSessionId=null, showSummary=false
4. Create reducers:
   - setViewMode(state, action: PayloadAction<ViewMode>)
   - openDrawer(state, action: PayloadAction<string>) - sets isDrawerOpen=true, selectedSessionId
   - closeDrawer(state) - sets isDrawerOpen=false, selectedSessionId=null
   - showSummaryModal(state) - sets showSummary=true
   - hideSummaryModal(state) - sets showSummary=false
5. Export all actions and the reducer

Use createSlice from @reduxjs/toolkit, PayloadAction for types.
  </action>
  <verify>File exists at src/features/ui/uiSlice.ts and exports: setViewMode, openDrawer, closeDrawer, showSummaryModal, hideSummaryModal</verify>
  <done>UI slice created with all required state and actions</done>
</task>

<task type="auto">
  <name>Update store with UI slice</name>
  <files>src/app/store.ts</files>
  <action>
Update src/app/store.ts:

1. Import uiReducer from '../features/ui/uiSlice'
2. Add ui: uiReducer to the reducer configuration
3. Update the comment at the top to reflect Phase 9 completion

Keep timer slice and timerPersistenceMiddleware as-is. Only add UI slice.
  </action>
  <verify>TypeScript compiles without error: npm run build or npx tsc --noEmit</verify>
  <done>Store configured with UI slice</done>
</task>

<task type="auto">
  <name>Wire App.tsx to Redux for UI state</name>
  <files>src/App.tsx</files>
  <action>
Refactor App.tsx to use Redux for UI state:

1. Import { useAppSelector, useAppDispatch } from './app/hooks'
2. Import { setViewMode, openDrawer, closeDrawer, showSummaryModal, hideSummaryModal } from './features/ui/uiSlice'
3. Remove local useState for: viewMode, selectedSession, isDrawerOpen, showSummary
4. Replace with:
   - const dispatch = useAppDispatch()
   - const viewMode = useAppSelector(state => state.ui.viewMode)
   - const isDrawerOpen = useAppSelector(state => state.ui.isDrawerOpen)
   - const selectedSession = useAppSelector(state => state.ui.selectedSessionId)
   - const showSummary = useAppSelector(state => state.ui.showSummary)
5. Update all setViewMode calls to dispatch(setViewMode(...))
6. Update drawer handlers:
   - handleSessionClick: dispatch(openDrawer(session.id))
   - handleDrawerClose: dispatch(closeDrawer())
7. Update summary handlers:
   - setShowSummary(true) -> dispatch(showSummaryModal())
   - setShowSummary(false) -> dispatch(hideSummaryModal())

Preserve existing session/completion logic - only migrate UI state.
  </action>
  <verify>App builds without errors and renders correctly. Redux DevTools shows ui state changes.</verify>
  <done>App.tsx uses Redux for viewMode, drawer, and summary modal state</done>
</task>

</tasks>

<verification>
- [ ] uiSlice.ts created at src/features/ui/
- [ ] Store includes ui reducer
- [ ] App.tsx uses useAppSelector for viewMode, isDrawerOpen, showSummary
- [ ] App.tsx uses useAppDispatch for state changes
- [ ] TypeScript compiles without errors
</verification>

<success_criteria>
1. viewMode (timer/history/stats/settings) state managed in Redux
2. History drawer open/close state managed in Redux
3. Session summary modal visibility controlled via Redux actions
4. Components require no changes (useSessionNotes unchanged)
</success_criteria>

<output>
After completion, create `.planning/phases/09-ui-session-slices/09-01-SUMMARY.md`
</output>
