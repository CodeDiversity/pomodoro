---
phase: 19-editor-component
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/RichTextEditor.tsx
autonomous: false
requirements:
  - RTE-01
  - RTE-02
  - RTE-03
  - RTE-04
  - RTE-05

must_haves:
  truths:
    - "RichTextEditor renders with toolbar above editable area"
    - "Bold button toggles bold on selected text"
    - "Bullet list button toggles bullet list on current line"
    - "Link button prompts for URL and inserts clickable link"
    - "Toolbar buttons show active state when formatting is applied"
  artifacts:
    - path: src/components/RichTextEditor.tsx
      provides: Editable rich text editor with toolbar
      min_lines: 100
      exports: RichTextEditor component
  key_links:
    - from: RichTextEditor.tsx
      to: @tiptap/react useEditor
      via: useEditor hook
      pattern: useEditor
    - from: ToolbarButton onClick
      to: editor.chain().focus().toggleBold()
      via: click handler
      pattern: toggleBold|toggleBulletList|setLink
---

<objective>
Create RichTextEditor component with functional Bold, Bullet List, and Link toolbar buttons using Tiptap.

**Purpose:** Provide editable rich text component that outputs HTML for session notes. This builds on Phase 18's infrastructure (RichTextDisplay, sanitize.ts) by adding editing capability.

**Output:** src/components/RichTextEditor.tsx - React component with toolbar and editor area
</objective>

<execution_context>
@/Users/michaelrobert/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelrobert/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-editor-infrastructure/18-01-SUMMARY.md
@.planning/phases/19-editor-component/19-RESEARCH.md

# Phase 18 created:
- src/components/RichTextDisplay.tsx (read-only rendering)
- src/utils/sanitize.ts (XSS sanitization)

# Phase 19 builds:
- src/components/RichTextEditor.tsx (editable with toolbar)

# Tech stack (already installed):
- @tiptap/react
- @tiptap/starter-kit
- @tiptap/extension-link
- react-icons
- styled-components
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RichTextEditor component with Tiptap</name>
  <files>src/components/RichTextEditor.tsx</files>
  <action>
Create src/components/RichTextEditor.tsx with:

1. **Interface**: RichTextEditorProps with { content: string, onChange: (html: string) => void, placeholder?: string }

2. **Editor setup** using useEditor:
   - Extensions: StarterKit (with heading, codeBlock, blockquote, horizontalRule disabled), Link (openOnClick: false, rel: noopener noreferrer nofollow)
   - onUpdate callback calls onChange(editor.getHTML())
   - editorProps adds 'tiptap' class

3. **Toolbar** with styled buttons:
   - Bold button: editor.chain().focus().toggleBold().run(), shows active state via editor.isActive('bold')
   - Bullet List button: editor.chain().focus().toggleBulletList().run(), shows active state via editor.isActive('bulletList')
   - Link button: handles link insertion/removal via window.prompt (see RESEARCH.md pattern)

4. **Styled components**:
   - EditorWrapper: border, border-radius, overflow hidden, background
   - Toolbar: flex row, gap, padding, border-bottom
   - ToolbarButton: 32x32, flex center, $isActive prop for styling, hover states
   - EditorArea: .tiptap class with min-height, padding, typography, ul/ol padding

5. **Icons**: Use inline SVG icons (BoldIcon, ListIcon, LinkIcon) as shown in RESEARCH.md

6. **Null check**: if (!editor) return null

Reference RESEARCH.md Pattern 1 (useEditor), Pattern 2 (toolbar active state), Pattern 3 (link insertion), Pattern 4 (styled content).
  </action>
  <verify>
npm run build passes without errors
npm run lint passes (if lint exists)
Verify RichTextEditor.tsx exports default component
  </verify>
  <done>
RichTextEditor component exists at src/components/RichTextEditor.tsx with:
- Toolbar with Bold, Bullet List, Link buttons
- Working toggleBold(), toggleBulletList(), setLink() commands
- Active state styling when format is applied
- onChange callback returns HTML string
- Minimum 100 lines of code
  </done>
</task>

<task type="checkpoint:human-verify" gate="non-blocking">
  <name>Task 2: Verify RichTextEditor renders and toolbar buttons work</name>
  <files>src/components/RichTextEditor.tsx</files>
  <action>
Manually test the RichTextEditor component:
1. Run app locally: npm run dev
2. Import and render RichTextEditor in a test component or temporary page
3. Verify toolbar appears with 3 buttons (Bold, List, Link)
4. Type text, select it, click Bold - verify text becomes bold
5. Type on new line, click Bullet List - verify bullet appears
6. Select text, click Link, enter URL - verify link is inserted
7. Verify active state styling on buttons when formats are applied
  </action>
  <verify>
Manual testing in browser:
- Bold toggles on/off correctly
- Bullet list toggles on/off correctly
- Link insertion with URL prompt works
- Active states display correctly on buttons
  </verify>
  <done>
RichTextEditor renders in browser with:
- Toolbar with Bold, Bullet List, Link buttons visible
- Each button functional when clicked
- Active state styling updates when formatting applied
  </done>
</task>

</tasks>

<verification>
- [ ] TypeScript compiles without errors
- [ ] Build succeeds (npm run build)
- [ ] RichTextEditor.tsx created with all 3 toolbar buttons
- [ ] Each button wired to correct Tiptap command
- [ ] Active state works via isActive() checks
- [ ] Link insertion handles URL input and removal
</verification>

<success_criteria>
RichTextEditor component is complete with:
1. Bold button toggles bold on selected text (RTE-01)
2. Bullet list button toggles bullet list (RTE-02)
3. Link button inserts/removes links with URL input (RTE-03)
4. Editor renders with toolbar (RTE-04)
5. Toolbar buttons are styled and show active state (RTE-05)
</success_criteria>

<output>
After completion, create `.planning/phases/19-editor-component/19-01-SUMMARY.md`
</output>
