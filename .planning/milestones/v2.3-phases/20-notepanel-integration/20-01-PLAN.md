---
phase: 20-notepanel-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - /Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx
autonomous: true
requirements:
  - RTE-04
  - RTE-05
must_haves:
  truths:
    - "Active Focus session shows RichTextEditor instead of plain textarea"
    - "Toolbar buttons (Bold, Bullet List, Link) appear in NotePanel and are functional"
    - "Editing a note and saving preserves formatting in IndexedDB"
  artifacts:
    - path: "/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx"
      provides: "NotePanel with integrated RichTextEditor"
      contains: "import RichTextEditor"
    - path: "/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/RichTextEditor.tsx"
      provides: "RichTextEditor component with toolbar"
      exports: "RichTextEditor"
  key_links:
    - from: "NotePanel.tsx"
      to: "RichTextEditor.tsx"
      via: "import and render"
      pattern: "import RichTextEditor.*from.*RichTextEditor"
    - from: "NotePanel.tsx (note state)"
      to: "RichTextEditor component"
      via: "content prop and onChange callback"
      pattern: "content=\\{noteText\\}.*onChange=\\{onNoteChange\\}"
---

<objective>
Integrate RichTextEditor into NotePanel to replace plain textarea with rich text editing capabilities during active focus sessions.
</objective>

<context>
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/20-notepanel-integration/20-RESEARCH.md
@/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/RichTextEditor.tsx
@/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx
</context>

<tasks>

<task type="auto">
  <name>Import RichTextEditor and replace textarea</name>
  <files>/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx</files>
  <action>
1. Add import at top of file: `import RichTextEditor from './RichTextEditor'`
2. In the Session Notes section (lines 451-470), replace the entire NotesContainer content:
   - REMOVE: `<Toolbar>` with `<ToolbarButton>` elements (lines 454-464)
   - REMOVE: `<TextArea>` element (lines 465-469)
   - ADD: `<RichTextEditor content={noteText} onChange={onNoteChange} />`
3. The NotesContainer wrapper should remain around the RichTextEditor to maintain border styling.
  </action>
  <verify>
  <automated>grep -n "RichTextEditor" /Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx</automated>
  <manual>Run the app, start a focus session, verify rich text toolbar appears above notes area</manual>
  </verify>
  <done>RichTextEditor renders in NotePanel with Bold, Bullet List, Link toolbar buttons</done>
</task>

<task type="auto">
  <name>Remove unused icons and toolbar components</name>
  <files>/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx</files>
  <action>
1. Remove BoldIcon function (lines 324-329)
2. Remove ListIcon function (lines 331-340)
3. Remove LinkIcon function (lines 342-347)
4. Remove Toolbar styled component (lines 100-106)
5. Remove ToolbarButton styled component (lines 108-129)
6. Verify the component still compiles and renders correctly
  </action>
  <verify>
  <automated>npm run build 2>&1 | head -20</automated>
  <manual>Check that the app builds without errors and no duplicate toolbars appear</manual>
  </verify>
  <done>Unused icon definitions and toolbar styled components removed from NotePanel.tsx</done>
</task>

<task type="auto">
  <name>Verify rich text functionality works end-to-end</name>
  <files>/Users/michaelrobert/Documents/GitHub/pomodoro/src/components/NotePanel.tsx</files>
  <action>
1. Start a focus session in the app
2. Type some text in the notes area
3. Use Bold button to format text - verify bold works
4. Use Bullet List button - verify bullet list works
5. Use Link button, enter a URL - verify link is created
6. Complete the session - verify the formatted notes are saved
7. Check IndexedDB to confirm HTML is stored correctly
  </action>
  <verify>
  <manual>Run `npm run dev` and manually test: start focus session, add formatted notes, complete session, verify notes persist with formatting</manual>
  </verify>
  <done>Rich text formatting (bold, bullets, links) works in NotePanel and persists after session completion</done>
</task>

</tasks>

<verification>
1. NotePanel imports and renders RichTextEditor component
2. Bold, Bullet List, Link toolbar buttons are visible and functional in NotePanel
3. Formatted notes (bold, bullets, links) save to IndexedDB correctly
4. Session summary displays the formatted notes (will show HTML tags until Phase 21)
</verification>

<success_criteria>
- Active Focus session shows RichTextEditor instead of plain textarea
- Toolbar buttons (Bold, Bullet, Link) appear in NotePanel and are functional
- Editing a note and saving preserves formatting in IndexedDB
- All Phase 20 requirements (RTE-04, RTE-05) are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/20-notepanel-integration/20-01-SUMMARY.md`
</output>
